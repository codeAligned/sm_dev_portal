{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/FilterPanel.js","../../js/src/OptionsPanel.js","../../js/src/removeElement.js","../../js/src/PicksPanel.js","../../js/src/MultiSelectInputAspect.js","../../js/src/PlaceholderAsInputAspect.js","../../js/src/EventSkipper.js","../../js/src/MultiSelect.js","../../js/src/LabelAdapter.js","../../js/src/OptionsAdapters.js","../../js/src/Tools.js","../../js/src/Bs4StylingMethodCss.js","../../js/src/Bs4StylingMethodJs.js","../../js/src/Bs4Styling.js","../../js/src/AddToJQueryPrototype.js","../../js/src/Bs4SelectedItemContent.js","../../js/src/Bs4DropDownItemContent.js","../../js/src/ContainerAdapter.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["function defFilterInputStyleSys(s) {s.border='0px'; s.padding='0px'; s.outline='none'; s.backgroundColor='transparent' };\r\n\r\nfunction FilterPanel(\r\n        createElement,\r\n        insertIntoDom,\r\n        onFocusIn,  // show dropdown\r\n        onFocusOut, // hide dropdown\r\n        onKeyDownArrowUp, \r\n        onKeyDownArrowDown,\r\n        onTabForEmpty,  // tab on empty\r\n        onBackspace, // backspace alike\r\n        onEnterOrTabToCompleate, // \"compleate alike\"\r\n        onKeyDownEsc, \r\n        onKeyUpEsc, // \"esc\" alike\r\n        onInput, // filter\r\n        setEmptyLength\r\n    ) {\r\n    \r\n    var inputElement = createElement('INPUT'); \r\n    \r\n    inputElement.setAttribute(\"type\",\"search\");\r\n    inputElement.setAttribute(\"autocomplete\",\"off\");\r\n\r\n    defFilterInputStyleSys(inputElement.style);\r\n\r\n    insertIntoDom(inputElement);\r\n\r\n    var onfilterInputKeyDown = (event) => {\r\n        if ([38, 40, 13 ,27].indexOf(event.which)>=0 \r\n            || (event.which == 9 && inputElement.value) ) {\r\n            event.preventDefault(); \r\n            // preventDefault for tab(9) it enables keyup,\r\n            // prevent form default button (13-enter) \r\n            // but doesn't help with bootsrap modal ESC or ENTER (close behaviour);\r\n            // esc(27) there is just in case\r\n        }\r\n        if (event.which == 27 ) {\r\n            onKeyDownEsc(inputElement.value?false:true, event); // support BS do not close modal - event.stopPropagation inside\r\n        }\r\n        else if (event.which == 38) {\r\n            onKeyDownArrowUp();\r\n        }\r\n        else if (event.which == 40) {\r\n            onKeyDownArrowDown();\r\n        }\r\n        else if (event.which == 9  /*tab*/) { // no keydown for this\r\n            if (!inputElement.value) {\r\n                 onTabForEmpty(); // filter is empty, nothing to reset\r\n            }\r\n        }\r\n        else if (event.which == 8 /*backspace*/) {\r\n            // NOTE: this will process backspace only if there are no text in the input field\r\n            // If user will find this inconvinient, we will need to calculate something like this\r\n            // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n            if (!inputElement.value)\r\n            { \r\n                onBackspace();\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n    \r\n    var onFilterInputKeyUp = (event) => {\r\n        if (event.which == 13 || event.which == 9) {\r\n            onEnterOrTabToCompleate();\r\n        }\r\n        else if (event.which == 27) { // escape\r\n            onKeyUpEsc(); // is it always empty (bs x can still it) \r\n        }\r\n    }\r\n    \r\n    // it can be initated by 3PP functionality\r\n    // sample (1) BS functionality - input x button click - clears input\r\n    // sample (2) BS functionality - esc keydown - clears input\r\n    // and there could be difference in processing: (2) should hide the menu, then reset , when (1) should just reset without hiding.\r\n    var onFilterInputInput = () => {\r\n        var filterInputValue = inputElement.value;\r\n        onInput(\r\n            filterInputValue, \r\n            ()=> inputElement.style.width = filterInputValue.length*1.3 + 2 + \"ch\"\r\n        );\r\n    }\r\n    \r\n    inputElement.addEventListener('focusin', onFocusIn);\r\n    inputElement.addEventListener('focusout', onFocusOut);\r\n    inputElement.addEventListener('keydown', onfilterInputKeyDown);    \r\n    inputElement.addEventListener('keyup', onFilterInputKeyUp);\r\n    inputElement.addEventListener('input', onFilterInputInput);\r\n\r\n    // function setEmptyLength(){\r\n    //     inputElement.style.width= \"100%\"; //--\"1rem\";\r\n    // }\r\n    //setEmptyLength();\r\n\r\n    function setEmpty(){\r\n        inputElement.value ='';\r\n        setEmptyLength();\r\n    };\r\n    \r\n    return {\r\n        inputElement,\r\n        isEmpty(){\r\n            return inputElement.value ? false:true;\r\n        },\r\n        setEmpty,\r\n        setEmptyLength,\r\n        setFocus(){\r\n            inputElement.focus();\r\n        },\r\n        isEventTarget(event){\r\n            return event.target == inputElement;\r\n        },\r\n        dispose(){\r\n            inputElement.removeEventListener('focusin', onFocusIn);\r\n            inputElement.removeEventListener('focusout', onFocusOut);\r\n            inputElement.removeEventListener('keydown', onfilterInputKeyDown);\r\n            inputElement.removeEventListener('keyup', onFilterInputKeyUp);\r\n            inputElement.removeEventListener('input', onFilterInputInput);\r\n        }\r\n    }\r\n}\r\n\r\nexport default FilterPanel;","function defDropDownMenuStyleSys(s) {s.listStyleType='none'}; // remove bullets since this is ul\r\n\r\nfunction OptionsPanel(createElement, dropDownMenu, onShow, onHide, eventSkipper, dropDownItemContent, styling, \r\n        getVisibleMultiSelectDataList, resetFilter, updateDropDownLocation, filterPanelSetFocus) {\r\n    \r\n    // prevent heavy understandable styling error\r\n    defDropDownMenuStyleSys(dropDownMenu.style);\r\n    var hoveredMultiSelectData=null;\r\n    var hoveredMultiSelectDataIndex = null;\r\n    var candidateToHoveredMultiSelectData=null;\r\n\r\n    function hideDropDown() {\r\n        if (candidateToHoveredMultiSelectData){\r\n            resetCandidateToHoveredMultiSelectData();\r\n        }\r\n        if (dropDownMenu.style.display != 'none')\r\n        {\r\n            dropDownMenu.style.display = 'none';\r\n            onHide();\r\n        }\r\n    }\r\n\r\n    function showDropDown() {\r\n        if (dropDownMenu.style.display != 'block')\r\n        {\r\n            eventSkipper.setSkippable();\r\n            dropDownMenu.style.display = 'block';\r\n            onShow();\r\n        }\r\n    }\r\n\r\n    var hoverInInternal = function(index){\r\n        hoveredMultiSelectDataIndex = index;\r\n        hoveredMultiSelectData = getVisibleMultiSelectDataList()[index];\r\n        styling.HoverIn(hoveredMultiSelectData.dropDownMenuItemElement);\r\n    }\r\n\r\n    function resetDropDownMenuHover() {\r\n        if (hoveredMultiSelectData) {\r\n            styling.HoverOut(hoveredMultiSelectData.dropDownMenuItemElement);\r\n            hoveredMultiSelectData = null;\r\n            hoveredMultiSelectDataIndex = null;\r\n        }\r\n    }\r\n\r\n    var resetCandidateToHoveredMultiSelectData = function(){\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousemove', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData.dropDownMenuItemElement.removeEventListener('mousedown', processCandidateToHovered);\r\n        candidateToHoveredMultiSelectData = null;\r\n    }\r\n\r\n    var processCandidateToHovered = function() {\r\n        if (hoveredMultiSelectData != candidateToHoveredMultiSelectData)\r\n        {\r\n            resetDropDownMenuHover(); \r\n            hoverInInternal(candidateToHoveredMultiSelectData.visibleIndex);\r\n        }\r\n        if(candidateToHoveredMultiSelectData) \r\n            resetCandidateToHoveredMultiSelectData();\r\n    }\r\n\r\n    function toggleHovered(){\r\n        if (hoveredMultiSelectData) {\r\n            hoveredMultiSelectData.toggle();\r\n            resetDropDownMenuHover();\r\n            hideDropDown(); // always hide 1st\r\n            resetFilter();\r\n        } \r\n    }\r\n\r\n    function keyDownArrow(down) {\r\n        let visibleMultiSelectDataList = getVisibleMultiSelectDataList();\r\n        let length = visibleMultiSelectDataList.length;\r\n        let newIndex=null;\r\n        if (length > 0) {\r\n            if (down) {\r\n                let i = hoveredMultiSelectDataIndex==null?0:hoveredMultiSelectDataIndex+1;\r\n                while(i<length){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i++;\r\n                }\r\n            } else {\r\n                let i = hoveredMultiSelectDataIndex==null?length-1:hoveredMultiSelectDataIndex-1;\r\n                while(i>=0){\r\n                    if (visibleMultiSelectDataList[i].visible){\r\n                        newIndex=i;\r\n                        break;\r\n                    }\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (newIndex!=null)\r\n        {\r\n            if (hoveredMultiSelectData)\r\n                styling.HoverOut(hoveredMultiSelectData.dropDownMenuItemElement);\r\n            updateDropDownLocation();\r\n            showDropDown(); \r\n            hoverInInternal(newIndex);\r\n        }\r\n    }\r\n\r\n    var onDropDownMenuItemElementMouseoverGeneral = function(MultiSelectData, dropDownMenuItemElement)\r\n    {\r\n        if (eventSkipper.isSkippable())\r\n        {\r\n            if(candidateToHoveredMultiSelectData)\r\n                resetCandidateToHoveredMultiSelectData()\r\n\r\n            candidateToHoveredMultiSelectData = MultiSelectData;\r\n            dropDownMenuItemElement.addEventListener('mousemove', processCandidateToHovered);\r\n            dropDownMenuItemElement.addEventListener('mousedown', processCandidateToHovered);\r\n        }\r\n        else\r\n        {\r\n            if (hoveredMultiSelectData!=MultiSelectData)\r\n            {\r\n                // mouseleave is not enough to guarantee remove hover styles in situations\r\n                // when style was setuped without mouse (keyboard arrows)\r\n                // therefore force reset manually\r\n                resetDropDownMenuHover(); \r\n                hoverInInternal(MultiSelectData.visibleIndex);\r\n            }                \r\n        }\r\n    }\r\n\r\n    function insertDropDownItem(MultiSelectData, createSelectedItemGen, setSelected, triggerChange, isSelected, isOptionDisabled) {\r\n        var dropDownMenuItemElement = createElement('LI');\r\n        \r\n        // in chrome it happens on \"become visible\" so we need to skip it, \r\n        // for IE11 and edge it doesn't happens, but for IE11 and Edge it doesn't happens on small \r\n        // mouse moves inside the item. \r\n        // https://stackoverflow.com/questions/59022563/browser-events-mouseover-doesnt-happen-when-you-make-element-visible-and-mous\r\n        \r\n        var onDropDownMenuItemElementMouseover = () => onDropDownMenuItemElementMouseoverGeneral(\r\n            MultiSelectData,\r\n            dropDownMenuItemElement\r\n        )\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseover', onDropDownMenuItemElementMouseover);\r\n        \r\n        // note 1: mouseleave preferred to mouseout - which fires on each descendant\r\n        // note 2: since I want add aditional info panels to the dropdown put mouseleave on dropdwon would not work\r\n        var onDropDownMenuItemElementMouseleave = () => {\r\n            if (!eventSkipper.isSkippable()) {\r\n                resetDropDownMenuHover();\r\n            }\r\n        }\r\n\r\n        dropDownMenuItemElement.addEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n\r\n        dropDownMenu.appendChild(dropDownMenuItemElement);\r\n\r\n        let content = dropDownItemContent(dropDownMenuItemElement, MultiSelectData.option); \r\n        MultiSelectData.dropDownMenuItemElement = dropDownMenuItemElement;\r\n        MultiSelectData.DropDownItemContent = content;\r\n\r\n        MultiSelectData.DisposeDropDownMenuItemElement = ()=> {\r\n            dropDownMenuItemElement.removeEventListener('mouseover',  onDropDownMenuItemElementMouseover);\r\n            dropDownMenuItemElement.removeEventListener('mouseleave', onDropDownMenuItemElementMouseleave);\r\n        }\r\n\r\n        var setDropDownItemContentDisabled = (content,  isSelected) => {\r\n            content.disabledStyle(true);\r\n            // do not desable if selected! there should be possibility to unselect \"disabled\"\r\n            content.disable(!isSelected);\r\n        }\r\n\r\n        if (isOptionDisabled)\r\n            setDropDownItemContentDisabled(content, isSelected )\r\n\r\n        content.onSelected( () => {\r\n            MultiSelectData.toggle();\r\n            filterPanelSetFocus();\r\n        });\r\n        // ------------------------------------------------------------------------------\r\n        \r\n        var createSelectedItem = () => createSelectedItemGen(\r\n            MultiSelectData,\r\n            isOptionDisabled,\r\n            () => setDropDownItemContentDisabled(content, false)\r\n        );\r\n        \r\n        if (isSelected)\r\n        {\r\n            createSelectedItem();\r\n        }\r\n        else\r\n        {\r\n            MultiSelectData.excludedFromSearch =  isOptionDisabled;\r\n            if (isOptionDisabled)\r\n                MultiSelectData.toggle = () => { }\r\n            else\r\n                MultiSelectData.toggle = () =>  {\r\n                    var confirmed = setSelected(MultiSelectData.option, true);\r\n                    if (confirmed==null || confirmed) {\r\n                        createSelectedItem();\r\n                        triggerChange();\r\n                    }\r\n                }\r\n        }\r\n        // TODO: refactore it\r\n    }\r\n\r\n    var item = {\r\n        hoverInInternal,\r\n        stopAndResetDropDownMenuHover(){\r\n            eventSkipper.setSkippable(); //disable Hover On MouseEnter - filter's changes should remove hover\r\n            resetDropDownMenuHover();\r\n        },\r\n        showDropDown,\r\n        hideDropDown,\r\n        toggleHovered,\r\n        keyDownArrow,\r\n        insertDropDownItem,\r\n        getIsVisble(){\r\n            return dropDownMenu.style.display != 'none';\r\n        }\r\n        \r\n    }\r\n    return item;\r\n}\r\n\r\nexport default OptionsPanel;","function removeElement(e) {e.parentNode.removeChild(e)}\r\nexport default removeElement;","import removeElement from './removeElement.js'\r\n\r\nfunction defSelectedPanelStyleSys(s) {s.display='flex'; s.flexWrap='wrap'; s.listStyleType='none'};  // remove bullets since this is ul\r\n\r\n\r\nfunction PicksPanel (\r\n        setSelected,\r\n        createElement,\r\n        picksElement, \r\n        init, \r\n        selectedItemContent, \r\n        isComponentDisabled, \r\n        triggerChange, \r\n        onRemove,\r\n        onClick,\r\n        onPicksEmptyChanged, //placeholderAspect.updatePlacehodlerVisibility(); call the same on enable/disable\r\n        processRemoveButtonClick\r\n) \r\n{\r\n    var picksCount = 0;\r\n    function inc(){picksCount++; if (picksCount==1) onPicksEmptyChanged()};\r\n    function dec(){picksCount--; if (picksCount==0) onPicksEmptyChanged()};\r\n    function reset(){picksCount=0; ; onPicksEmptyChanged()}\r\n    function isEmpty(){return picksCount==0};\r\n\r\n    defSelectedPanelStyleSys(picksElement.style); \r\n\r\n    var inputItemElement = createElement('LI'); // detached\r\n  \r\n    \r\n    \r\n    picksElement.appendChild(inputItemElement); // located filter in selectionsPanel\r\n    \r\n   \r\n\r\n    init(inputItemElement);\r\n    var MultiSelectDataSelectedTail = null;\r\n\r\n    function removeSelectedTail(){\r\n        if (MultiSelectDataSelectedTail){ \r\n            MultiSelectDataSelectedTail.toggle(); // always remove in this case\r\n        }\r\n    }\r\n\r\n    function removeSelectedFromList(MultiSelectData){\r\n        if (MultiSelectData.selectedPrev){\r\n            (MultiSelectData.selectedPrev).selectedNext = MultiSelectData.selectedNext;\r\n        }\r\n        if (MultiSelectData.selectedNext){\r\n           (MultiSelectData.selectedNext).selectedPrev = MultiSelectData.selectedPrev;\r\n        }\r\n        if (MultiSelectDataSelectedTail == MultiSelectData){\r\n            MultiSelectDataSelectedTail = MultiSelectData.selectedPrev;\r\n        }\r\n        MultiSelectData.selectedNext=null;\r\n        MultiSelectData.selectedPrev=null;\r\n    }\r\n\r\n\r\n    function createSelectedItem(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled) {\r\n        \r\n        var selectedItemElement = createElement('LI');\r\n        MultiSelectData.selectedItemElement = selectedItemElement;\r\n        if (MultiSelectDataSelectedTail){\r\n            MultiSelectDataSelectedTail.selectedNext = MultiSelectData;\r\n            MultiSelectData.selectedPrev = MultiSelectDataSelectedTail;\r\n        }\r\n        MultiSelectDataSelectedTail = MultiSelectData;\r\n\r\n        var removeSelectedItem = () => {\r\n            let confirmed = setSelected(MultiSelectData.option, false);\r\n            if (confirmed==null || confirmed) {\r\n                MultiSelectData.excludedFromSearch = isOptionDisabled;\r\n                if (isOptionDisabled)\r\n                {\r\n                    setDropDownItemContentDisabled(MultiSelectData.DropDownItemContent, false);\r\n                    MultiSelectData.toggle = ()=> {};\r\n                }\r\n                else\r\n                {\r\n                    MultiSelectData.toggle = ()=>{\r\n                        let confirmed = setSelected(MultiSelectData.option, true);\r\n                        if (confirmed==null || confirmed){\r\n                            createSelectedItem(MultiSelectData, isOptionDisabled, setDropDownItemContentDisabled);\r\n                            triggerChange();\r\n                        }\r\n                    };\r\n                }\r\n                MultiSelectData.DropDownItemContent.select(false);\r\n                removeElement(selectedItemElement);\r\n                MultiSelectData.SelectedItemContent.dispose();\r\n                MultiSelectData.SelectedItemContent=null;\r\n                MultiSelectData.selectedItemElement=null;\r\n\r\n                removeSelectedFromList(MultiSelectData);\r\n                dec();\r\n                triggerChange();\r\n            }\r\n        }\r\n\r\n        // processRemoveButtonClick removes the \r\n        // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n        // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n        // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n        // because of the event's bubling process removeSelectedItem runs first. \r\n        // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n        // before we could analize is it belong to our dropdown or not.\r\n        // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n        // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n        // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n        // the situation described above: click outside dropdown on the same component.\r\n        // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n\r\n        let removeSelectedItemAndCloseDropDown = () => {\r\n            removeSelectedItem();\r\n            onRemove();\r\n        };\r\n    \r\n        let onRemoveSelectedItemEvent = (event) => {\r\n            processRemoveButtonClick(() => removeSelectedItemAndCloseDropDown(), event);\r\n        };\r\n\r\n        MultiSelectData.SelectedItemContent = selectedItemContent(\r\n            selectedItemElement,\r\n            MultiSelectData.option,\r\n            onRemoveSelectedItemEvent);\r\n\r\n        var disable = (isDisabled) =>\r\n            MultiSelectData.SelectedItemContent.disable(isDisabled);\r\n        disable(isComponentDisabled);\r\n\r\n        MultiSelectData.excludedFromSearch = true; // all selected excluded from search\r\n        MultiSelectData.disable = disable;\r\n        picksElement.insertBefore(selectedItemElement, inputItemElement);\r\n         \r\n        MultiSelectData.toggle = () => removeSelectedItem();\r\n        MultiSelectData.DropDownItemContent.select(true);\r\n        inc();\r\n    }\r\n\r\n    var selectedPanelClick = event => {\r\n        onClick(event);\r\n    };\r\n\r\n    function iterateAll(isDisabled){\r\n        let i = MultiSelectDataSelectedTail;\r\n        while(i){\r\n            i.disable(isDisabled); \r\n            i = i.selectedPrev;\r\n        }\r\n    }\r\n\r\n    var item = {\r\n        inputItemElement,\r\n        insert(selectedItemElement){\r\n            this.selectedPanel.insertBefore(selectedItemElement, inputItemElement);\r\n        },\r\n        createSelectedItem,\r\n        removeSelectedTail,\r\n        resetMultiSelectDataSelectedTail() {\r\n            reset();\r\n            MultiSelectDataSelectedTail = null;\r\n        },\r\n        isEmpty,\r\n        enable(){\r\n            isComponentDisabled= false;\r\n            iterateAll(false);\r\n            picksElement.addEventListener(\"click\", selectedPanelClick);\r\n\r\n        },\r\n        disable(){\r\n            isComponentDisabled= true;\r\n            iterateAll(true);\r\n            picksElement.removeEventListener(\"click\", selectedPanelClick);\r\n\r\n        },\r\n        dispose(){\r\n            var toRemove = picksElement.firstChild;\r\n            while( toRemove ) {\r\n                picksElement.removeChild( toRemove );\r\n                toRemove = picksElement.firstChild;\r\n            }\r\n            picksElement.removeEventListener(\"click\", selectedPanelClick); // OPEN dropdown\r\n        }\r\n        \r\n    }\r\n    return item;\r\n}\r\n\r\nexport default PicksPanel;","function MultiSelectInputAspect (\r\n    window,\r\n    appendToContainer, \r\n    filterInputItem, \r\n    picksElement,\r\n    optionsElement, \r\n    showDropDown,\r\n    hideDropDownAndResetFilter,\r\n    isDropDownMenuEmpty,\r\n    Popper\r\n    ) {\r\n\r\n        appendToContainer();\r\n        var document = window.document;\r\n\r\n    var skipFocusout = false;\r\n    \r\n    // we want to escape the closing of the menu (because of focus out from) on a user's click inside the container\r\n    var skipoutMousedown = function() {\r\n         skipFocusout = true;\r\n    }\r\n\r\n    var documentMouseup = function(event) {\r\n        // if click outside container - close dropdown\r\n        if (  !(optionsElement === event.target \r\n                || picksElement === event.target \r\n                || optionsElement.contains(event.target)\r\n                || picksElement.contains(event.target)\r\n               )\r\n            ) {\r\n            hideDropDownAndResetFilter();\r\n        }\r\n    }\r\n\r\n    var popper = new Popper( \r\n        filterInputItem, \r\n        optionsElement, \r\n        {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: {enabled:false}\r\n            }\r\n        }\r\n    );\r\n\r\n    var filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n    var preventDefaultClickEvent = null;\r\n\r\n    function alignAndShowDropDown(event){\r\n        if (preventDefaultClickEvent != event) {\r\n            if (!isDropDownMenuEmpty())\r\n            {\r\n                alignToFilterInputItemLocation(true);\r\n                showDropDown();\r\n            }\r\n        }\r\n        preventDefaultClickEvent=null;\r\n    }\r\n    \r\n    function alignToFilterInputItemLocation(force) {\r\n        let offsetLeft = filterInputItem.offsetLeft;\r\n        if (force || filterInputItemOffsetLeft != offsetLeft){ // position changed\r\n            popper.update();\r\n            filterInputItemOffsetLeft = offsetLeft;\r\n        }\r\n    }\r\n\r\n    return {\r\n        dispose(){\r\n            popper.destroy();\r\n        },\r\n        alignToFilterInputItemLocation,\r\n        alignAndShowDropDown,\r\n        processUncheck(uncheckOption, event){\r\n            // we can't remove item on \"click\" in the same loop iteration - it is unfrendly for 3PP event handlers (they will get detached element)\r\n            // never remove elements in the same event iteration\r\n\r\n            window.setTimeout(()=>uncheckOption(),0)\r\n            preventDefaultClickEvent = event; // setPreventDefaultMultiSelectEvent\r\n        },\r\n        onDropDownShow(){\r\n            // add listeners that manages close dropdown on input's focusout and click outside container\r\n            //container.removeEventListener(\"mousedown\", containerMousedown);\r\n\r\n            picksElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            optionsElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.addEventListener(\"mouseup\", documentMouseup);\r\n            \r\n        },\r\n        onDropDownHide(){\r\n            picksElement.removeEventListener(\"mousedown\", skipoutMousedown);\r\n            optionsElement.addEventListener(\"mousedown\", skipoutMousedown);\r\n            document.removeEventListener(\"mouseup\", documentMouseup);\r\n        },\r\n        getSkipFocusout : function() {\r\n             return skipFocusout;\r\n        },\r\n        resetSkipFocusout : function() {\r\n             skipFocusout=false;\r\n        }\r\n    }\r\n}\r\n\r\nexport default MultiSelectInputAspect;","export default function PlaceholderAsInputAspect(placeholderText, picksIsEmpty, filterIsEmpty, picksElement, inputElement ){\r\n    function setEmptyInputWidth(isVisible){\r\n        if(isVisible)\r\n            inputElement.style.width=\"100%\"\r\n        else\r\n            inputElement.style.width=\"2ch\";\r\n    }\r\n\r\n    function showPlacehodler(isVisible){\r\n        if (isVisible)\r\n        {\r\n            inputElement.placeholder = placeholderText?placeholderText:\"\";\r\n            picksElement.style.display= \"block\";\r\n        }\r\n        else\r\n        {\r\n            inputElement.placeholder = \"\";\r\n            picksElement.style.display= \"flex\";\r\n        }\r\n        setEmptyInputWidth(isVisible);\r\n    }\r\n    showPlacehodler(true);\r\n\r\n    return {\r\n        init(){\r\n        },\r\n        updatePlacehodlerVisibility(){\r\n            showPlacehodler(picksIsEmpty() && filterIsEmpty());\r\n        },\r\n        updateEmptyInputWidth(){\r\n            setEmptyInputWidth(picksIsEmpty() && filterIsEmpty())\r\n        },\r\n        setDisabled(isDisabled)\r\n        { \r\n            inputElement.disabled = isDisabled;\r\n        }\r\n    }\r\n}","export default function EventSkipper(window) {\r\n    var isSkippable = false;\r\n    return {\r\n        isSkippable(){\r\n            return isSkippable;\r\n        },\r\n        setSkippable(){\r\n            isSkippable = true;\r\n            window.setTimeout( \r\n                () => {  \r\n                    isSkippable = false;\r\n                }, 0)\r\n        }\r\n    }\r\n}","import Popper from 'popper.js'\r\nimport FilterPanel from './FilterPanel.js'\r\nimport OptionsPanel from './OptionsPanel.js'\r\nimport PicksPanel from './PicksPanel.js'\r\nimport MultiSelectInputAspect from './MultiSelectInputAspect.js'\r\n//import PlaceholderAsElementAspect from './PlaceholderAsElementAspect.js'\r\nimport PlaceholderAsInputAspect from './PlaceholderAsInputAspect.js'\r\n\r\nimport EventSkipper from './EventSkipper.js'\r\nimport removeElement from './removeElement.js'\r\n\r\nfunction filterMultiSelectData(MultiSelectData, isFiltered, visibleIndex) {\r\n    MultiSelectData.visible = isFiltered;\r\n    MultiSelectData.visibleIndex = visibleIndex;\r\n    MultiSelectData.dropDownMenuItemElement.style.display = isFiltered ? 'block': 'none';\r\n} \r\n\r\nfunction resetDropDownMenu(MultiSelectDataList) {\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            filterMultiSelectData(multiSelectData, true, i);\r\n        }\r\n    }\r\n}\r\n\r\nfunction collectFilterDropDownMenu(MultiSelectDataList, text) {\r\n    var list = [];\r\n    var j = 0;\r\n    for(let i=0; i<MultiSelectDataList.length; i++)\r\n    {\r\n        let multiSelectData = MultiSelectDataList[i];\r\n        if ( !multiSelectData.isHidden )\r\n        {\r\n            if ( multiSelectData.excludedFromSearch || multiSelectData.searchText.indexOf(text)<0 )\r\n            {\r\n                filterMultiSelectData(multiSelectData, false);\r\n            }\r\n            else \r\n            {\r\n                filterMultiSelectData(multiSelectData, true, j++);\r\n                list.push( multiSelectData );\r\n            }\r\n        }\r\n    }\r\n    return list;\r\n}\r\n\r\nclass MultiSelect {\r\n    constructor(optionsAdapter, setSelected, containerAdapter, styling, \r\n        selectedItemContent, dropDownItemContent, \r\n        labelAdapter, createStylingComposite, placeholderText,\r\n        configuration, onDispose, window) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n\r\n        this.onDispose = onDispose; // public\r\n\r\n        // readonly\r\n        this.optionsAdapter = optionsAdapter;\r\n        this.containerAdapter = containerAdapter;\r\n        this.styling = styling;\r\n        this.selectedItemContent = selectedItemContent;\r\n        this.dropDownItemContent = dropDownItemContent;\r\n        this.labelAdapter = labelAdapter;\r\n        this.createStylingComposite = createStylingComposite;\r\n        this.configuration = configuration;\r\n        this.placeholderText = placeholderText;\r\n        this.setSelected=setSelected; // should I rebind this for callbacks? setSelected.bind(this);\r\n        this.window = window;\r\n\r\n        this.visibleCount=10;\r\n\r\n        this.optionsPanel = null;\r\n\r\n        this.stylingComposite = null;\r\n\r\n        this.isComponentDisabled = null;\r\n                \r\n        this.resetMultiSelectDataList();\r\n    }\r\n\r\n    resetMultiSelectDataList(){\r\n        this.MultiSelectDataList = [];\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    \r\n    getVisibleMultiSelectDataList(){\r\n        if (this.filteredMultiSelectDataList)\r\n            return this.filteredMultiSelectDataList;\r\n        else\r\n            return this.MultiSelectDataList;\r\n    }\r\n\r\n    resetFilter(){\r\n        if (!this.filterPanel.isEmpty()) {\r\n            this.filterPanel.setEmpty();\r\n            this.processEmptyInput();\r\n            this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n    }\r\n\r\n    processEmptyInput(){\r\n        this.filterPanel.setEmptyLength();\r\n        resetDropDownMenu(this.MultiSelectDataList);\r\n        this.filteredMultiSelectDataList = null;\r\n    }\r\n\r\n    // -----------------------------------------------------------------------------------------------------------------------\r\n    GetContainer(){\r\n        return this.containerAdapter.container;\r\n    }\r\n\r\n    Update(){\r\n        this.UpdateIsValid();\r\n        this.UpdateSize();\r\n        this.UpdateDisabled();\r\n        this.UpdateData();\r\n    }\r\n\r\n    /*\r\n    UpdateOption(index){\r\n        let multiSelectData = this.MultiSelectDataList[index];\r\n        let option = multiSelectData.option;\r\n        multiSelectData.searchText = option.text.toLowerCase().trim();\r\n        if (multiSelectData.isHidden != option.isHidden)\r\n        {\r\n            multiSelectData.isHidden=option.isHidden;\r\n            if (multiSelectData.isHidden)\r\n                this.optionsPanel.insertDropDownItem(multiSelectData, \r\n                    (p1,p2,p3)=>this.picksPanel.createSelectedItem(p1,p2,p3),\r\n                    ()=>this.optionsAdapter.triggerChange(),\r\n                    option.isSelected, option.isDisabled);\r\n            else\r\n                multiSelectData.removeDropDownMenuItemElement();\r\n        }\r\n        else \r\n        {\r\n            if (multiSelectData.isSelected != option.isSelected)\r\n            {\r\n                multiSelectData.isSelected=option.isSelected;\r\n                if (multiSelectData.isSelected)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n            if (multiSelectData.isDisabled != option.isDisabled)\r\n            {\r\n                multiSelectData.isDisabled=option.isDisabled;\r\n                if (multiSelectData.isDisabled)\r\n                {\r\n                    // this.insertDropDownItem(multiSelectData, (e)=>this.dropDownMenu.appendChild(e), isSelected, isDisabled);\r\n                }\r\n                else\r\n                {\r\n                    // multiSelectData.removeDropDownMenuItemElement();\r\n                }\r\n            }\r\n        }    \r\n        //multiSelectData.updateOption();\r\n    }*/\r\n\r\n    DeselectAll(){\r\n        this.optionsPanel.hideDropDown(); // always hide 1st\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.selectedItemElement)\r\n                multiSelectData.toggle();\r\n        }\r\n        this.resetFilter();\r\n        \r\n    }\r\n\r\n    SelectAll(){\r\n        this.optionsPanel.hideDropDown(); // always hide 1st\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (!multiSelectData.excludedFromSearch)\r\n                multiSelectData.toggle();\r\n        }\r\n        this.resetFilter();\r\n    }\r\n\r\n    empty(){\r\n        // close drop down , remove filter and listeners\r\n        this.optionsPanel.hideDropDown(); // always hide 1st\r\n        this.resetFilter();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            if (multiSelectData.dropDownMenuItemElement)\r\n                removeElement(multiSelectData.dropDownMenuItemElement);\r\n            if (multiSelectData.selectedItemElement)\r\n                removeElement(multiSelectData.selectedItemElement);\r\n        }\r\n        this.resetMultiSelectDataList();\r\n        this.picksPanel.resetMultiSelectDataSelectedTail();// this.MultiSelectDataSelectedTail = null;\r\n    }\r\n\r\n    UpdateData(){\r\n        this.empty();\r\n        // reinitiate\r\n        this.updateDataImpl();\r\n        \r\n    }\r\n\r\n    updateDataImpl(){\r\n        var createDropDownItems = () => {\r\n            let options = this.optionsAdapter.getOptions();\r\n            var j = 0;\r\n            for(let i = 0; i<options.length; i++) {\r\n                let option = options[i];\r\n\r\n                let isSelected = option.selected;\r\n\r\n                let isDisabled = (option.disabled)?option.disabled:false;\r\n                let isHidden   = (option.hidden)?option.hidden:false;\r\n                \r\n                var MultiSelectData = {\r\n                    searchText: option.text.toLowerCase().trim(),\r\n                    excludedFromSearch: isSelected || isDisabled || isHidden,\r\n                    option: option,\r\n                    isHidden: isHidden,\r\n                    dropDownMenuItemElement: null,\r\n                    dropDownItemContent: null,\r\n                    selectedPrev: null,\r\n                    selectedNext: null,\r\n                    visible: false,\r\n                    toggle: null,\r\n                    selectedItemElement: null,\r\n                    remove: null,\r\n                    disable: null,\r\n                    removeDropDownMenuItemElement: null\r\n                };\r\n\r\n                this.MultiSelectDataList.push(MultiSelectData);\r\n                if (!isHidden){\r\n                    MultiSelectData.visible = true;\r\n                    MultiSelectData.visibleIndex=i;\r\n                    this.optionsPanel.insertDropDownItem(\r\n                        MultiSelectData, \r\n                        (p1,p2,p3) => this.picksPanel.createSelectedItem(p1,p2,p3),\r\n                        (o,i) => this.setSelected(o,i),\r\n                        () => this.optionsAdapter.triggerChange(), \r\n                        isSelected, \r\n                        isDisabled);\r\n                }\r\n            } \r\n            this.aspect.alignToFilterInputItemLocation(false);\r\n            //this.placeholderAspect.updatePlacehodlerVisibility();\r\n        }\r\n\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        if (document.readyState != 'loading'){\r\n            createDropDownItems();\r\n        } else {\r\n            var createDropDownItemsHandler = function(){\r\n                createDropDownItems();\r\n                document.removeEventListener(\"DOMContentLoaded\", createDropDownItemsHandler);\r\n            }\r\n            document.addEventListener('DOMContentLoaded', createDropDownItemsHandler); // IE9+\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose(); // primary used to remove from jQuery tables\r\n        \r\n        // remove event listeners\r\n        // TODO check if open\r\n        this.optionsPanel.hideDropDown();\r\n        if (this.optionsAdapter.dispose)\r\n            this.optionsAdapter.dispose();\r\n        this.picksPanel.dispose();\r\n        this.filterPanel.dispose();\r\n        \r\n        this.labelAdapter.dispose();\r\n        \r\n        this.aspect.dispose();\r\n        \r\n        this.containerAdapter.dispose();\r\n\r\n        for(let i=0; i<this.MultiSelectDataList.length; i++)\r\n        {\r\n            let multiSelectData = this.MultiSelectDataList[i];\r\n            multiSelectData.toggle = null;\r\n            multiSelectData.remove = null; \r\n            multiSelectData.removeDropDownMenuItemElement = null;\r\n            if (multiSelectData.DisposeDropDownMenuItemElement)\r\n                multiSelectData.DisposeDropDownMenuItemElement();\r\n            \r\n            if (multiSelectData.SelectedItemContent)\r\n                multiSelectData.SelectedItemContent.dispose();\r\n            if (multiSelectData.DropDownItemContent)\r\n                multiSelectData.DropDownItemContent.dispose();\r\n        }\r\n    }\r\n\r\n    UpdateSize(){\r\n        if (this.styling.UpdateSize){\r\n            this.styling.UpdateSize(this.stylingComposite, this.optionsAdapter.getSize() );\r\n        }\r\n        //this.placeholderAspect.updatePadding();\r\n    }\r\n\r\n    UpdateIsValid(){\r\n        if (this.styling.UpdateIsValid)\r\n            this.styling.UpdateIsValid(this.stylingComposite, this.optionsAdapter.getIsValid(), this.optionsAdapter.getIsInvalid());\r\n    }\r\n\r\n    UpdateDisabled(){\r\n        let isComponentDisabled = this.optionsAdapter.getDisabled();\r\n        if (this.isComponentDisabled!==isComponentDisabled){\r\n            if (isComponentDisabled) {\r\n                this.picksPanel.disable();\r\n                this.placeholderAspect.setDisabled(true);\r\n                this.styling.Disable(this.stylingComposite);\r\n            } else {\r\n                this.picksPanel.enable();\r\n                this.placeholderAspect.setDisabled(false);\r\n                this.styling.Enable(this.stylingComposite);\r\n            }\r\n            this.isComponentDisabled=isComponentDisabled;\r\n        }\r\n    }\r\n \r\n    input(filterInputValue, resetLength){\r\n        let text = filterInputValue.trim().toLowerCase();\r\n        var isEmpty=false;\r\n        if (text == '')\r\n            isEmpty=true;\r\n        else\r\n        {\r\n            // check if exact match, otherwise new search\r\n            this.filteredMultiSelectDataList = collectFilterDropDownMenu(this.MultiSelectDataList, text);\r\n            if (this.filteredMultiSelectDataList.length == 1)\r\n            {\r\n                let fullMatchMultiSelectData =  this.filteredMultiSelectDataList[0];\r\n                if (fullMatchMultiSelectData.searchText == text)\r\n                {\r\n                    fullMatchMultiSelectData.toggle();\r\n                    this.filterPanel.setEmpty(); // clear\r\n                    isEmpty=true;\r\n                }\r\n            }\r\n        }\r\n        if (isEmpty)\r\n            this.processEmptyInput();\r\n        else\r\n            resetLength();  \r\n        \r\n        \r\n        this.optionsPanel.stopAndResetDropDownMenuHover();\r\n        if (this.getVisibleMultiSelectDataList().length == 1) {\r\n            this.optionsPanel.hoverInInternal(0)\r\n        }\r\n\r\n        if (this.getVisibleMultiSelectDataList().length > 0) {\r\n            this.aspect.alignToFilterInputItemLocation(true); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.optionsPanel.showDropDown();\r\n        } else {\r\n            this.optionsPanel.hideDropDown();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        var document = this.window.document;\r\n        var createElement = (name) => document.createElement(name);\r\n        let container = this.containerAdapter.container;\r\n\r\n        var lazyfilterItemInputElementAtach=null;\r\n        \r\n        this.filterPanel = FilterPanel(\r\n            createElement,\r\n            (filterItemInputElement) => {\r\n                lazyfilterItemInputElementAtach = (filterItemElement)=>{\r\n                    filterItemElement.appendChild(filterItemInputElement);\r\n                    this.labelAdapter.init(filterItemInputElement); \r\n                };\r\n            },\r\n            () => {\r\n                this.styling.FocusIn(this.stylingComposite)\r\n            },  // focus in - show dropdown\r\n            () => {\r\n                if (!this.aspect.getSkipFocusout()) // skip initiated by mouse click (we manage it different way)\r\n                {\r\n                    this.resetFilter(); // if do not do this we will return to filtered list without text filter in input\r\n                    this.styling.FocusOut(this.stylingComposite)\r\n                }\r\n                this.aspect.resetSkipFocusout();\r\n            }, // focus out - hide dropdown\r\n            () => this.optionsPanel.keyDownArrow(false), // arrow up\r\n            () => this.optionsPanel.keyDownArrow(true),  // arrow down\r\n            () => this.optionsPanel.hideDropDown(),  // tab on empty\r\n            () => {\r\n                this.picksPanel.removeSelectedTail();\r\n                this.aspect.alignToFilterInputItemLocation(false);\r\n            }, // backspace - \"remove last\"\r\n            () => { \r\n                if (this.optionsPanel.getIsVisble())\r\n                    this.optionsPanel.toggleHovered() }, // tab/enter \"compleate hovered\"\r\n            (isEmpty, event) => {\r\n                if (!isEmpty || this.optionsPanel.getIsVisble()) // supports bs modal - stop esc (close modal) propogation\r\n                    event.stopPropagation();\r\n            }, // esc keydown\r\n            () => {\r\n                this.optionsPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            }, // esc keyup \r\n            (filterInputValue, resetLength) =>\r\n            { \r\n                this.placeholderAspect.updatePlacehodlerVisibility();\r\n                this.input(filterInputValue, resetLength) \r\n            }, // filter\r\n            () => {\r\n                this.placeholderAspect.updateEmptyInputWidth();\r\n            }\r\n        );\r\n        \r\n        this.picksPanel =  PicksPanel(\r\n            this.setSelected,\r\n            createElement,\r\n            this.containerAdapter.picksElement,\r\n            (filterItemElement) => {\r\n                lazyfilterItemInputElementAtach(filterItemElement);\r\n            },\r\n            this.selectedItemContent,\r\n            this.isComponentDisabled,\r\n            () => this.optionsAdapter.triggerChange(),\r\n            () => {\r\n                this.optionsPanel.hideDropDown(); // always hide 1st\r\n                this.resetFilter();\r\n            },\r\n\r\n            (event) => {\r\n                if (!this.filterPanel.isEventTarget(event))\r\n                     this.filterPanel.setFocus();\r\n                this.aspect.alignAndShowDropDown(event); \r\n            },\r\n            ()=> this.placeholderAspect.updatePlacehodlerVisibility(),\r\n            (doUncheck, event) => {\r\n                this.aspect.processUncheck(doUncheck, event);\r\n            }\r\n        );\r\n\r\n        this.optionsPanel = OptionsPanel(\r\n            createElement,\r\n            this.containerAdapter.optionsElement,\r\n            () => this.aspect.onDropDownShow(),\r\n            () => this.aspect.onDropDownHide(),\r\n            EventSkipper(this.window),\r\n            this.dropDownItemContent,\r\n            this.styling, \r\n            () => this.getVisibleMultiSelectDataList(),\r\n            () => this.resetFilter(),\r\n            () => this.aspect.alignToFilterInputItemLocation(true),\r\n            () => this.filterPanel.setFocus()\r\n        );\r\n\r\n        // this.placeholderAspect = PlaceholderAsElementAspect(\r\n        //     this.placeholderText, \r\n        //     () => this.picksPanel.isEmpty(),\r\n        //     () => this.filterPanel.isEmpty(), \r\n        //     this.containerAdapter.picksElement,\r\n        //     this.filterPanel.inputElement, \r\n        //     createElement, \r\n        //     ()=>this.isComponentDisabled,\r\n        //     this.picksPanel.inputItemElement);\r\n\r\n        this.placeholderAspect = PlaceholderAsInputAspect(\r\n            this.placeholderText, \r\n            () => this.picksPanel.isEmpty(), \r\n            () => this.filterPanel.isEmpty(), \r\n            this.containerAdapter.picksElement, \r\n            this.filterPanel.inputElement\r\n        )\r\n\r\n        this.placeholderAspect.init();\r\n        this.placeholderAspect.updateEmptyInputWidth();\r\n        \r\n\r\n        this.aspect =  MultiSelectInputAspect(\r\n            this.window,\r\n            ()=>this.containerAdapter.appendToContainer(), \r\n            this.picksPanel.inputItemElement, \r\n            this.containerAdapter.picksElement, \r\n            this.containerAdapter.optionsElement, \r\n            () => this.optionsPanel.showDropDown(),\r\n            () => {  \r\n                this.optionsPanel.hideDropDown();\r\n                this.resetFilter();\r\n            },\r\n            () => this.getVisibleMultiSelectDataList().length==0, \r\n            Popper\r\n        );\r\n        \r\n        this.stylingComposite = this.createStylingComposite(container, \r\n            this.containerAdapter.picksElement,\r\n            this.picksPanel.placeholderItemElement, \r\n            this.picksPanel.inputItemElement, \r\n            this.filterPanel.inputElement, \r\n            this.containerAdapter.optionsElement);\r\n        \r\n        this.styling.Init(this.stylingComposite);\r\n\r\n        this.containerAdapter.attachContainer();\r\n\r\n        this.UpdateSize();            \r\n        this.UpdateIsValid();\r\n        this.UpdateDisabled(); // should be done after updateDataImpl\r\n        this.updateDataImpl();\r\n\r\n        if (this.optionsAdapter.subscribeToReset)\r\n            this.optionsAdapter.subscribeToReset(()=> this.window.setTimeout( ()=>this.UpdateData() ) );\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function LabelAdapter(label, createInputId){\r\n    var backupedFor = null; // state saved between init and dispose\r\n    return {\r\n        init(filterInput) {\r\n            if (label) {\r\n                backupedFor = label.getAttribute('for');\r\n                var newId = createInputId();\r\n                filterInput.setAttribute('id', newId);\r\n                label.setAttribute('for',newId);\r\n            }\r\n        },\r\n        dispose(){\r\n            if(backupedFor)\r\n                label.setAttribute('for',backupedFor);\r\n        }\r\n    }\r\n}\r\n\r\nexport default LabelAdapter;","function OptionsAdapterElement(selectElement, getDisabled, getSize, getIsValid, getIsInvalid, trigger, form) {\r\n    var backup;\r\n    return {\r\n        getOptions(){\r\n            return selectElement.getElementsByTagName('OPTION')\r\n        },\r\n        triggerChange(){\r\n            trigger('change')\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled,\r\n        getSize,\r\n        getIsValid,\r\n        getIsInvalid,\r\n        subscribeToReset(handler){\r\n            backup = handler;\r\n            if (form)\r\n                form.addEventListener('reset', backup)\r\n        },\r\n        dispose(){\r\n            if (form && backup)\r\n                form.removeEventListener('reset', backup)\r\n        }\r\n    }\r\n}\r\n\r\nfunction OptionsAdapterJson(options, getDisabled, getSize, getIsValid, getIsInvalid, trigger) {\r\n    return {\r\n        getOptions(){\r\n            return options\r\n        },\r\n        triggerChange(){\r\n            trigger('multiselect:change')\r\n        },\r\n        getDisabled(){\r\n            return getDisabled?getDisabled():false\r\n        },\r\n        getSize(){\r\n            return getSize?getSize():null\r\n        },\r\n        getIsValid(){\r\n            return getIsValid?getIsValid():false\r\n        },\r\n        getIsInvalid(){\r\n            return getIsInvalid?getIsInvalid():false\r\n        }\r\n    }\r\n}\r\n\r\nexport {OptionsAdapterJson, OptionsAdapterElement}","export function ExtendIfUndefined(destination, source) {\r\n    for (var property in source)\r\n        if (destination[property] === undefined)\r\n            destination[property] = source[property];\r\n}\r\n\r\nexport function ExtendIfUndefinedFluent(destination, source) {\r\n    ExtendIfUndefined(destination, source);\r\n    return destination;\r\n}","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedPanelFocusClass : 'focus',\r\n    selectedPanelDisabledClass: 'disabled',\r\n    dropDownItemDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4StylingMethodCss(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n\r\n    return {\r\n        Enable($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelDisabledClass)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            $selectedPanel.addClass(configuration.selectedPanelFocusClass);\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n            $selectedPanel.removeClass(configuration.selectedPanelFocusClass);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodCss;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst defSelectedPanelStyle = {'margin-bottom': '0', 'height': 'auto'};\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n    selectedPanelLgMinHeight:  'calc(2.875rem + 2px)',\r\n    selectedPanelSmMinHeight:  'calc(1.8125rem + 2px)',\r\n    selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n    selectedPanelFocusBorderColor: '#80bdff',\r\n    selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n    selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n    selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n    filterInputColor: 'inherit', //'#495057',\r\n    filterInputFontWeight: 'inherit', //'#495057',\r\n    placeholderItemColor: '#6c757d'\r\n};\r\n\r\nfunction Bs4StylingMethodJs(configuration){\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n\r\n    return {\r\n        OnInit(composite){\r\n            composite.$selectedPanel.css(defSelectedPanelStyle);\r\n            composite.$filterInput.css(\"color\", configuration.filterInputColor);\r\n            composite.$filterInput.css(\"font-weight\", configuration.filterInputFontWeight);\r\n            if (composite.placeholderItem)\r\n                composite.$placeholderItem.css(\"color\", configuration.placeholderItemColor);\r\n        },\r\n    \r\n        UpdateSize($selectedPanel, size){\r\n            if (size==\"custom-select-lg\" || size==\"input-group-lg\"){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelLgMinHeight);\r\n            } else if (size==\"custom-select-sm\" || size==\"input-group-sm\"){\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelSmMinHeight);\r\n            } else {\r\n                $selectedPanel.css(\"min-height\", configuration.selectedPanelDefMinHeight);\r\n            }\r\n        },\r\n    \r\n        Enable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", \"\")\r\n        },\r\n    \r\n        Disable($selectedPanel){\r\n            $selectedPanel.css(\"background-color\", configuration.selectedPanelDisabledBackgroundColor)\r\n        },\r\n    \r\n        FocusIn($selectedPanel){\r\n            if ($selectedPanel.hasClass(\"is-valid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusValidBoxShadow);\r\n            } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n                $selectedPanel.css(\"box-shadow\", configuration.selectedPanelFocusInvalidBoxShadow);\r\n            } else {\r\n                $selectedPanel\r\n                    .css(\"box-shadow\", configuration.selectedPanelFocusBoxShadow)\r\n                    .css(\"border-color\", configuration.selectedPanelFocusBorderColor);\r\n            }\r\n        },\r\n    \r\n        FocusOut($selectedPanel){\r\n                $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n        },\r\n    }\r\n}\r\n\r\nexport default Bs4StylingMethodJs;","import  { ExtendIfUndefined } from './Tools';\r\n\r\n// Bs4Styling\r\nconst bs4StylingDefaults = {\r\n    containerClass: 'dashboardcode-bsmultiselect',\r\n    dropDownMenuClass: 'dropdown-menu',\r\n    dropDownItemClass:  'px-2',\r\n    dropDownItemHoverClass: 'text-primary bg-light',\r\n    selectedPanelClass: 'form-control',  \r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close',\r\n    placeholderItemClass: '',\r\n    filterInputItemClass: '',\r\n    filterInputClass: '',\r\n}\r\n\r\nfunction Bs4Styling(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4StylingDefaults);\r\n\r\n    return {\r\n        Init(composite){\r\n            composite.$container.addClass(configuration.containerClass);\r\n            composite.$selectedPanel.addClass(configuration.selectedPanelClass);\r\n            composite.$dropDownMenu.addClass(configuration.dropDownMenuClass);\r\n            composite.$filterInputItem.addClass(configuration.filterInputItemClass);\r\n            composite.$filterInput.addClass(configuration.filterInputClass);\r\n            if (stylingMethod.OnInit)\r\n                stylingMethod.OnInit(composite)\r\n        },\r\n\r\n        UpdateIsValid(composite, isValid, isInvalid){\r\n            if (isValid)\r\n                composite.$selectedPanel.addClass('is-valid');\r\n\r\n            if (isInvalid)\r\n                composite.$selectedPanel.addClass('is-invalid');\r\n        },\r\n\r\n        UpdateSize(composite, size){\r\n                if (size==\"custom-select-lg\"){\r\n                    composite.$selectedPanel.addClass('form-control-lg');\r\n                    composite.$selectedPanel.removeClass('form-control-sm');\r\n                }\r\n                else if (size==\"custom-select-sm\"){\r\n                    composite.$selectedPanel.removeClass('form-control-lg');\r\n                    composite.$selectedPanel.addClass('form-control-sm');\r\n                }\r\n                else{\r\n                    composite.$selectedPanel.removeClass('form-control-lg');\r\n                    composite.$selectedPanel.removeClass('form-control-sm');\r\n                }\r\n            if(stylingMethod.UpdateSize)\r\n               stylingMethod.UpdateSize(composite.$selectedPanel, size)\r\n        },\r\n\r\n        Enable(composite){\r\n            stylingMethod.Enable(composite.$selectedPanel)\r\n        },\r\n\r\n        Disable(composite){\r\n            stylingMethod.Disable(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusIn(composite){\r\n            stylingMethod.FocusIn(composite.$selectedPanel)\r\n        },\r\n\r\n        FocusOut(composite){\r\n            stylingMethod.FocusOut(composite.$selectedPanel)\r\n        },\r\n\r\n        HoverIn(dropDownItem){\r\n            $(dropDownItem).addClass(configuration.dropDownItemHoverClass);\r\n        },\r\n\r\n        HoverOut(dropDownItem){\r\n            $(dropDownItem).removeClass(configuration.dropDownItemHoverClass);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nexport default Bs4Styling;","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype;","import  { ExtendIfUndefined } from './Tools';\r\n\r\nconst bs4StylingMethodCssdefaults = {\r\n    selectedItemContentDisabledClass: 'disabled'\r\n};\r\n\r\nfunction Bs4SelectedItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssdefaults);\r\n\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.addClass(configuration.selectedItemContentDisabledClass )\r\n        }\r\n    }\r\n}\r\n\r\nconst defSelectedItemStyle = {'padding-left': '0px', 'line-height': '1.5em'};\r\nconst defRemoveSelectedItemButtonStyle = {'font-size':'1.5em', 'line-height': '.9em'};\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65'\r\n };\r\n\r\nfunction Bs4SelectedItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return {\r\n        disableSelectedItemContent($content){\r\n            $content.css(\"opacity\", configuration.selectedItemContentDisabledOpacity )\r\n        },\r\n    \r\n        createSelectedItemContent($selectedItem, $button){\r\n            $selectedItem.css(defSelectedItemStyle);\r\n            if ($button)\r\n                $button.css(defRemoveSelectedItemButtonStyle);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4SelectedItemContentDefaults = {\r\n    selectedItemClass: 'badge',\r\n    removeSelectedItemButtonClass: 'close'\r\n};\r\nfunction Bs4SelectedItemContent(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4SelectedItemContentDefaults);\r\n    \r\n    return function (selectedItem, optionItem, removeSelectedItem){\r\n            let $selectedItem = $(selectedItem)\r\n            $selectedItem.addClass(configuration.selectedItemClass);\r\n            let $content = $(`<span/>`).text(optionItem.text);\r\n            $content.appendTo($selectedItem);\r\n            if (optionItem.disabled ){\r\n                stylingMethod.disableSelectedItemContent($content);\r\n            }\r\n\r\n            let $button = $('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n                // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n                // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n                .css(\"float\", \"none\").appendTo($selectedItem)\r\n                .addClass(configuration.removeSelectedItemButtonClass) // bs close class set the float:right\r\n                .on(\"click\", \r\n                    jqEvent =>    \r\n                        removeSelectedItem(jqEvent.originalEvent)\r\n                    );\r\n            if (stylingMethod.createSelectedItemContent)\r\n                stylingMethod.createSelectedItemContent($selectedItem, $button);\r\n            return {\r\n                disable(isDisabled){ \r\n                    $button.prop('disabled', isDisabled); \r\n                },\r\n                dispose(){\r\n                    $button.unbind();\r\n                }\r\n            };\r\n        }\r\n}\r\n\r\nexport { Bs4SelectedItemContent as Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss};","import  { ExtendIfUndefined} from './Tools';\r\n\r\nconst bs4StylingMethodCssDefaults = {\r\n    selectedItemContentDisabledClass: 'disabled',\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodCss(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodCssDefaults);\r\n    return {\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            if (isDisbaled) \r\n                $checkBox.addClass(configuration.dropDownItemDisabledClass);\r\n            else\r\n                $checkBox.removeClass(configuration.dropDownItemDisabledClass);\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4StylingMethodJsDefaults = {\r\n    selectedItemContentDisabledOpacity: '.65',\r\n    dropdDownLabelDisabledColor: '#6c757d'\r\n};\r\n\r\nfunction Bs4DropDownItemContentStylingMethodJs(configuration) {\r\n    ExtendIfUndefined(configuration, bs4StylingMethodJsDefaults);\r\n    return{\r\n        disabledStyle($checkBox, $checkBoxLabel, isDisbaled){\r\n            $checkBoxLabel.css('color', isDisbaled?configuration.dropdDownLabelDisabledColor:'')\r\n        }\r\n    }\r\n}\r\n\r\nconst bs4DropDownItemContentDefaults = {\r\n    dropDownItemClass:  'px-2',\r\n}\r\n\r\nfunction Bs4DropDownItemContent(stylingMethod, configuration, $) {\r\n    ExtendIfUndefined(configuration, bs4DropDownItemContentDefaults);\r\n    return function(dropDownItem, option){\r\n        let $dropDownItem = $(dropDownItem);\r\n        $dropDownItem.addClass(configuration.dropDownItemClass);\r\n        let $dropDownItemContent= $(`<div class=\"custom-control custom-checkbox\">\r\n            <input type=\"checkbox\" class=\"custom-control-input\">\r\n            <label class=\"custom-control-label justify-content-start\"></label>\r\n        </div>`);\r\n        $dropDownItemContent.appendTo(dropDownItem);\r\n        let $checkBox = $dropDownItemContent.find(`INPUT[type=\"checkbox\"]`);\r\n        let $checkBoxLabel = $dropDownItemContent.find(`label`);\r\n        $checkBoxLabel.text(option.text);\r\n\r\n        var tmp = { \r\n            select(isSelected){ $checkBox.prop('checked', isSelected); }, \r\n            // --- distinct disable and disabledStyle to provide a possibility to unselect disabled option\r\n            disable(isDisabled){ $checkBox.prop('disabled', isDisabled); },\r\n            disabledStyle(isDisbaled){ stylingMethod.disabledStyle($checkBox, $checkBoxLabel, isDisbaled); },\r\n\r\n            onSelected(toggle) {\r\n                $checkBox.on(\"change\", toggle)\r\n                $dropDownItem.on(\"click\", event => {\r\n                    if (dropDownItem === event.target || $.contains(dropDownItem, event.target)) {\r\n                        toggle();\r\n                    }\r\n                })\r\n            },\r\n            dispose(){\r\n                $checkBox.unbind();\r\n                $dropDownItem.unbind();\r\n            }\r\n        }\r\n        \r\n        return tmp;\r\n    }\r\n}\r\n\r\nexport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss };","/*\r\n// 1\r\n<select name=\"States1\" id=\"edit-states1-id\" class=\"form-control\" \r\n        multiple=\"multiple\" style=\"display: none;\"> <!-- plugin element-->\r\n                <option value=\"AL\">Alabama</option>\r\n                <option value=\"AK\" disabled=\"\">Alaska</option>\r\n</select>\r\n\r\n// 2\r\n<div class=\"dashboardcode-bsmultiselect\"> \r\n    <div class=\"input-group\" >\r\n        <div class=\"input-group-prepend\">\r\n            <button class=\"btn btn-outline-secondary\" type=\"button\">Button</button>\r\n        </div>\r\n\r\n        <select name=\"States1\" id=\"edit-states1-id\" class=\"form-control\"\r\n            multiple=\"multiple\" style=\"display: none;\">  <!-- plugin element-->\r\n                <option value=\"AL\">Alabama</option>\r\n                <option value=\"AK\" disabled=\"\">Alaska</option>\r\n        </select>\r\n\r\n        <ul class=\"form-control\"></ul> <!-- optional - for \"no flick\" -->\r\n    </div>\r\n</div>\r\n\r\n// 2\r\n<div></div> \r\n\r\n// 3\r\n<div class=\"dashboardcode-bsmultiselect\">\r\n    <div class=\"input-group\" >\r\n        <div class=\"input-group-prepend\">\r\n            <button class=\"btn btn-outline-secondary\" type=\"button\">Button</button>\r\n        </div>\r\n\r\n        <ul class=\"form-control\"></ul> <!-- json plugin key element -->\r\n    </div>\r\n</div>\r\n*/\r\n\r\nexport default function ContainerAdapter(createElement, selectElement, containerElement, picksElement) { // select\r\n    var ownContainerElement = false;\r\n    var ownPicksElement = false;\r\n    \r\n    if (!containerElement){\r\n        containerElement = createElement('div');\r\n        ownContainerElement= true;\r\n    }\r\n    if (!picksElement){\r\n        picksElement = createElement('UL');\r\n        ownPicksElement = true;\r\n    }\r\n\r\n    var optionsElement = createElement('UL');\r\n    optionsElement.style.display=\"none\";\r\n    \r\n    var backupDisplay = null;\r\n    if (selectElement)\r\n    { \r\n        backupDisplay = selectElement.style.display;\r\n        selectElement.style.display='none';\r\n    }\r\n    \r\n    return {\r\n        container: containerElement,\r\n        picksElement,\r\n        optionsElement,\r\n        init(){\r\n            if (ownPicksElement)\r\n                containerElement.appendChild(picksElement);\r\n        },\r\n        appendToContainer(){\r\n            if (ownContainerElement || !selectElement)            \r\n            {\r\n                if (ownPicksElement)\r\n                    containerElement.appendChild(picksElement);\r\n                containerElement.appendChild(optionsElement);\r\n            }\r\n            else\r\n            {\r\n                if (selectElement)\r\n                {\r\n                    selectElement.parentNode.insertBefore(optionsElement, selectElement.nextSibling);\r\n                    if (ownPicksElement)\r\n                        selectElement.parentNode.insertBefore(picksElement, optionsElement);\r\n                }\r\n            }\r\n        },\r\n        attachContainer(){\r\n            if (ownContainerElement)\r\n                selectElement.parentNode.insertBefore(containerElement, selectElement.nextSibling);\r\n        },\r\n        dispose(){\r\n            if (ownContainerElement)\r\n                containerElement.parentNode.removeChild(containerElement);\r\n            if (ownPicksElement)\r\n                picksElement.parentNode.removeChild(picksElement);\r\n            optionsElement.parentNode.removeChild(optionsElement);\r\n            if (selectElement)\r\n                selectElement.style.display = backupDisplay;\r\n        }\r\n    }\r\n}","import $ from 'jquery'\r\n\r\nimport MultiSelect from './MultiSelect'\r\nimport LabelAdapter from './LabelAdapter';\r\nimport {OptionsAdapterJson,OptionsAdapterElement} from './OptionsAdapters';\r\n\r\nimport Bs4StylingMethodCss from './Bs4StylingMethodCss'\r\nimport Bs4StylingMethodJs from './Bs4StylingMethodJs'\r\nimport Bs4Styling from './Bs4Styling';\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\n\r\nimport { Bs4SelectedItemContent, Bs4SelectedItemContentStylingMethodJs, Bs4SelectedItemContentStylingMethodCss} from './Bs4SelectedItemContent';\r\nimport { Bs4DropDownItemContent, Bs4DropDownItemContentStylingMethodJs, Bs4DropDownItemContentStylingMethodCss} from './Bs4DropDownItemContent';\r\nimport ContainerAdapter from './ContainerAdapter';\r\n\r\nfunction FindDirectChildByTagName(element, tagName){\r\n    var returnValue = null;\r\n    for (var i = 0; i<element.children.length;i++)\r\n    {\r\n        let tmp = element.children[i];\r\n        if (tmp.tagName==tagName)\r\n        {\r\n            returnValue = tmp;\r\n            break;\r\n        }\r\n    }\r\n    return returnValue;\r\n}\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, settings, onDispose) => {\r\n                let configuration = $.extend({}, settings); // settings used per jQuery intialization, configuration per element\r\n                if (configuration.buildConfiguration)\r\n                    configuration.buildConfiguration(element, configuration);\r\n                \r\n                let useCss = configuration.useCss;\r\n                let styling = configuration.styling;\r\n                if (!configuration.adapter)\r\n                {\r\n                    let stylingMethod = configuration.stylingMethod;\r\n                    if (!stylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            stylingMethod = Bs4StylingMethodCss(configuration);\r\n                        else\r\n                            stylingMethod = Bs4StylingMethodJs(configuration);\r\n                    }\r\n                    styling = Bs4Styling(stylingMethod, configuration, $);\r\n                }\r\n\r\n                let optionsAdapter = null;\r\n                let containerAdapter = null;\r\n                if (configuration.optionsAdapter)\r\n                    optionsAdapter = configuration.optionsAdapter;\r\n                else\r\n                {\r\n                    var createElement = function(name){\r\n                        return window.document.createElement(name);\r\n                    }\r\n                    var trigger = function(eventName){\r\n                        $(element).trigger(eventName);\r\n                    }\r\n                    if (configuration.options){\r\n                        optionsAdapter = OptionsAdapterJson(\r\n                            configuration.options,\r\n                            configuration.getDisabled,\r\n                            configuration.getSize,\r\n                            configuration.getIsValid,\r\n                            configuration.getIsInvalid,\r\n                            trigger );\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId = () => `${configuration.containerClass}-generated-filter-${element.id}`;\r\n                        // find direct child by tagName\r\n                        var picksElement = FindDirectChildByTagName(element, \"UL\");\r\n                        containerAdapter = ContainerAdapter(createElement, null, element, picksElement);\r\n                    } \r\n                    else  \r\n                    {\r\n                        var selectElement = null;\r\n                        var containerElement = null;\r\n                        if (element.tagName==\"SELECT\")\r\n                            selectElement = element;\r\n                        else \r\n                        { \r\n                            selectElement = FindDirectChildByTagName(element, \"SELECT\");\r\n                            if (!selectElement)\r\n                                throw \"There are no SELECT element or options in the configuraion\";\r\n                            containerElement = element;\r\n                        }\r\n\r\n                        if (!containerElement && configuration.containerClass)\r\n                        {\r\n                            var $container = $(selectElement).closest('.'+configuration.containerClass);\r\n                            if ($container.length>0)\r\n                                containerElement =  $container.get(0);\r\n                        }\r\n\r\n\r\n                        if (!configuration.label)\r\n                        {\r\n                            let $formGroup = $(selectElement).closest('.form-group');\r\n                            if ($formGroup.length == 1) {\r\n                                let $label = $formGroup.find(`label[for=\"${selectElement.id}\"]`);\r\n                                if ($label.length>0)\r\n                                {   \r\n                                    let label = $label.get(0);\r\n                                    let forId = label.getAttribute('for');\r\n                                    if (forId == selectElement.id) {\r\n                                        configuration.label = label;\r\n                                    }\r\n                                }   \r\n                            }\r\n                        }\r\n                        var $form = $(selectElement).closest('form');\r\n                        var form = null;\r\n                        if ($form.length == 1) {\r\n                            form = $form.get(0);\r\n                        }\r\n                        \r\n                        if (!configuration.getDisabled) {\r\n                            var $fieldset = $(selectElement).closest('fieldset');\r\n                        \r\n                            if ($fieldset.length == 1) {\r\n                                var fieldset = $fieldset.get(0);\r\n                                configuration.getDisabled = () => selectElement.disabled || fieldset.disabled;\r\n                            }else{\r\n                                configuration.getDisabled = () => selectElement.disabled;\r\n                            }\r\n                        }\r\n\r\n                        if (!configuration.getSize) {\r\n                            configuration.getSize = function(){\r\n                                var value=null;\r\n                                if (selectElement.classList.contains('custom-select-lg') || selectElement.classList.contains('form-control-lg') )\r\n                                    value='custom-select-lg';\r\n                                else if (selectElement.classList.contains('custom-select-sm')  || selectElement.classList.contains('form-control-sm')  )\r\n                                    value='custom-select-sm';\r\n                                else if (containerElement && containerElement.classList.contains('input-group-lg'))\r\n                                    value='input-group-lg';\r\n                                else if (containerElement && containerElement.classList.contains('input-group-sm'))\r\n                                    value='input-group-sm';\r\n                                return value;\r\n                            }\r\n                        }\r\n                        if (!configuration.getIsValid) {\r\n                            configuration.getIsValid = function()\r\n                            { return selectElement.classList.contains('is-valid')}\r\n                        }\r\n                        if (!configuration.getIsInvalid) {\r\n                            configuration.getIsInvalid = function()\r\n                            { return selectElement.classList.contains('is-invalid')}\r\n                        }\r\n                        optionsAdapter = OptionsAdapterElement(selectElement, configuration.getDisabled, \r\n                            configuration.getSize, \r\n                            configuration.getIsValid, configuration.getIsInvalid,\r\n                            trigger, form);\r\n\r\n                        if (!configuration.createInputId)\r\n                            configuration.createInputId = () => `${configuration.containerClass}-generated-input-${((selectElement.id)?selectElement.id:selectElement.name).toLowerCase()}-id`;\r\n\r\n                        \r\n                        var picksElement = null;\r\n                        if (containerElement)\r\n                            picksElement = FindDirectChildByTagName(containerElement, \"UL\");\r\n                        containerAdapter = ContainerAdapter(createElement, selectElement, containerElement, picksElement);\r\n                        \r\n                    }\r\n                }\r\n                let labelAdapter = LabelAdapter(configuration.label, configuration.createInputId);\r\n\r\n                let selectedItemContent = configuration.selectedItemContent;\r\n                if (!selectedItemContent){\r\n                    let selectedItemContentStylingMethod = configuration.selectedItemContentStylingMethod;\r\n                    if (!selectedItemContentStylingMethod)\r\n                    {\r\n                        if (useCss)\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodCss(configuration, $);\r\n                        else\r\n                            selectedItemContentStylingMethod=Bs4SelectedItemContentStylingMethodJs(configuration, $);\r\n                    }\r\n                    selectedItemContent = Bs4SelectedItemContent(selectedItemContentStylingMethod, configuration, $);\r\n                }\r\n\r\n                let dropDownItemContent = configuration.bs4DropDownItemContent;\r\n                if (!dropDownItemContent){\r\n                    let dropDownItemContentStylingMethod = configuration.dropDownItemContentStylingMethod;\r\n                    if (useCss)\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodCss(configuration, $);\r\n                    else\r\n                        dropDownItemContentStylingMethod=Bs4DropDownItemContentStylingMethodJs(configuration, $);\r\n                    dropDownItemContent = Bs4DropDownItemContent(dropDownItemContentStylingMethod, configuration, $)\r\n                }\r\n\r\n                let createStylingComposite = function(container, selectedPanel, placeholderItemElement, filterInputItem, filterInput, dropDownMenu){\r\n                    return {\r\n                        $container:$(container),\r\n                        $selectedPanel:$(selectedPanel),\r\n                        $placeholderItem:placeholderItemElement?$(placeholderItemElement):null,\r\n                        $filterInputItem:$(filterInputItem),\r\n                        $filterInput:$(filterInput),\r\n                        $dropDownMenu:$(dropDownMenu)\r\n                    };\r\n                }\r\n                var placeholderText = configuration.placeholder;\r\n                if (!placeholderText)\r\n                {\r\n                    if (selectElement)\r\n                        placeholderText = $(selectElement).data(\"bsmultiselect-placeholder\");\r\n                    else if (containerElement)                 \r\n                        placeholderText = $(containerElement).data(\"bsmultiselect-placeholder\");\r\n                }\r\n                \r\n                let setSelected = configuration.setSelected;\r\n                if (!setSelected){\r\n                    setSelected = (option, value)=> { option.selected = value;}\r\n                }\r\n\r\n                let multiSelect = new MultiSelect(\r\n                    optionsAdapter,\r\n                    setSelected,\r\n                    containerAdapter,\r\n                    styling,\r\n                    selectedItemContent,\r\n                    dropDownItemContent,\r\n                    labelAdapter,\r\n                    createStylingComposite,\r\n                    placeholderText,\r\n                    configuration,\r\n                    onDispose,\r\n                    window);\r\n                \r\n                if (configuration.init)\r\n                    configuration.init(element, multiSelect);\r\n                \r\n                multiSelect.init();\r\n\r\n                return multiSelect;\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["defFilterInputStyleSys","s","border","padding","outline","backgroundColor","FilterPanel","createElement","insertIntoDom","onFocusIn","onFocusOut","onKeyDownArrowUp","onKeyDownArrowDown","onTabForEmpty","onBackspace","onEnterOrTabToCompleate","onKeyDownEsc","onKeyUpEsc","onInput","setEmptyLength","inputElement","setAttribute","style","onfilterInputKeyDown","event","indexOf","which","value","preventDefault","onFilterInputKeyUp","onFilterInputInput","filterInputValue","width","length","addEventListener","setEmpty","isEmpty","setFocus","focus","isEventTarget","target","dispose","removeEventListener","defDropDownMenuStyleSys","listStyleType","OptionsPanel","dropDownMenu","onShow","onHide","eventSkipper","dropDownItemContent","styling","getVisibleMultiSelectDataList","resetFilter","updateDropDownLocation","filterPanelSetFocus","hoveredMultiSelectData","hoveredMultiSelectDataIndex","candidateToHoveredMultiSelectData","hideDropDown","resetCandidateToHoveredMultiSelectData","display","showDropDown","setSkippable","hoverInInternal","index","HoverIn","dropDownMenuItemElement","resetDropDownMenuHover","HoverOut","processCandidateToHovered","visibleIndex","toggleHovered","toggle","keyDownArrow","down","visibleMultiSelectDataList","newIndex","i","visible","onDropDownMenuItemElementMouseoverGeneral","MultiSelectData","isSkippable","insertDropDownItem","createSelectedItemGen","setSelected","triggerChange","isSelected","isOptionDisabled","onDropDownMenuItemElementMouseover","onDropDownMenuItemElementMouseleave","appendChild","content","option","DropDownItemContent","DisposeDropDownMenuItemElement","setDropDownItemContentDisabled","disabledStyle","disable","onSelected","createSelectedItem","excludedFromSearch","confirmed","item","stopAndResetDropDownMenuHover","getIsVisble","removeElement","e","parentNode","removeChild","defSelectedPanelStyleSys","flexWrap","PicksPanel","picksElement","init","selectedItemContent","isComponentDisabled","onRemove","onClick","onPicksEmptyChanged","processRemoveButtonClick","picksCount","inc","dec","reset","inputItemElement","MultiSelectDataSelectedTail","removeSelectedTail","removeSelectedFromList","selectedPrev","selectedNext","selectedItemElement","removeSelectedItem","select","SelectedItemContent","removeSelectedItemAndCloseDropDown","onRemoveSelectedItemEvent","isDisabled","insertBefore","selectedPanelClick","iterateAll","insert","selectedPanel","resetMultiSelectDataSelectedTail","enable","toRemove","firstChild","MultiSelectInputAspect","window","appendToContainer","filterInputItem","optionsElement","hideDropDownAndResetFilter","isDropDownMenuEmpty","Popper","document","skipFocusout","skipoutMousedown","documentMouseup","contains","popper","placement","modifiers","preventOverflow","enabled","hide","flip","filterInputItemOffsetLeft","preventDefaultClickEvent","alignAndShowDropDown","alignToFilterInputItemLocation","force","offsetLeft","update","destroy","processUncheck","uncheckOption","setTimeout","onDropDownShow","onDropDownHide","getSkipFocusout","resetSkipFocusout","PlaceholderAsInputAspect","placeholderText","picksIsEmpty","filterIsEmpty","setEmptyInputWidth","isVisible","showPlacehodler","placeholder","updatePlacehodlerVisibility","updateEmptyInputWidth","setDisabled","disabled","EventSkipper","filterMultiSelectData","isFiltered","resetDropDownMenu","MultiSelectDataList","multiSelectData","isHidden","collectFilterDropDownMenu","text","list","j","searchText","push","MultiSelect","optionsAdapter","containerAdapter","labelAdapter","createStylingComposite","configuration","onDispose","TypeError","visibleCount","optionsPanel","stylingComposite","resetMultiSelectDataList","filteredMultiSelectDataList","filterPanel","processEmptyInput","placeholderAspect","GetContainer","container","Update","UpdateIsValid","UpdateSize","UpdateDisabled","UpdateData","DeselectAll","SelectAll","empty","picksPanel","updateDataImpl","createDropDownItems","options","getOptions","selected","hidden","toLowerCase","trim","remove","removeDropDownMenuItemElement","p1","p2","p3","o","aspect","readyState","createDropDownItemsHandler","Dispose","getSize","getIsValid","getIsInvalid","getDisabled","Disable","Enable","input","resetLength","fullMatchMultiSelectData","name","lazyfilterItemInputElementAtach","filterItemInputElement","filterItemElement","FocusIn","FocusOut","stopPropagation","doUncheck","placeholderItemElement","Init","attachContainer","subscribeToReset","LabelAdapter","label","createInputId","backupedFor","filterInput","getAttribute","newId","OptionsAdapterElement","selectElement","trigger","form","backup","getElementsByTagName","handler","OptionsAdapterJson","ExtendIfUndefined","destination","source","property","undefined","bs4StylingMethodCssDefaults","selectedPanelFocusClass","selectedPanelDisabledClass","dropDownItemDisabledClass","Bs4StylingMethodCss","$selectedPanel","removeClass","addClass","defSelectedPanelStyle","bs4StylingMethodJsDefaults","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","filterInputFontWeight","placeholderItemColor","Bs4StylingMethodJs","OnInit","composite","css","$filterInput","placeholderItem","$placeholderItem","size","hasClass","bs4StylingDefaults","containerClass","dropDownMenuClass","dropDownItemClass","dropDownItemHoverClass","selectedPanelClass","selectedItemClass","removeSelectedItemButtonClass","placeholderItemClass","filterInputItemClass","filterInputClass","Bs4Styling","stylingMethod","$","$container","$dropDownMenu","$filterInputItem","isValid","isInvalid","dropDownItem","AddToJQueryPrototype","pluginName","createPlugin","firstChar","charAt","firstCharLower","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","each","$e","instance","data","isMethodName","test","optionsObject","removeData","methodName","noConflict","bs4StylingMethodCssdefaults","selectedItemContentDisabledClass","Bs4SelectedItemContentStylingMethodCss","disableSelectedItemContent","$content","defSelectedItemStyle","defRemoveSelectedItemButtonStyle","selectedItemContentDisabledOpacity","Bs4SelectedItemContentStylingMethodJs","createSelectedItemContent","$selectedItem","$button","bs4SelectedItemContentDefaults","Bs4SelectedItemContent","selectedItem","optionItem","appendTo","on","jqEvent","originalEvent","prop","unbind","Bs4DropDownItemContentStylingMethodCss","$checkBox","$checkBoxLabel","isDisbaled","dropdDownLabelDisabledColor","Bs4DropDownItemContentStylingMethodJs","bs4DropDownItemContentDefaults","Bs4DropDownItemContent","$dropDownItem","$dropDownItemContent","find","tmp","ContainerAdapter","containerElement","ownContainerElement","ownPicksElement","backupDisplay","nextSibling","FindDirectChildByTagName","element","tagName","returnValue","children","settings","extend","buildConfiguration","useCss","adapter","eventName","id","closest","get","$formGroup","$label","forId","$form","$fieldset","fieldset","classList","selectedItemContentStylingMethod","bs4DropDownItemContent","dropDownItemContentStylingMethod","multiSelect"],"mappings":"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"}